<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data Generation Tutorial â€¢ HBEST</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data Generation Tutorial">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HBEST</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.01</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Data_generation_tutorial.html">Data Generation Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/HBEST_tutorial.html">HBEST Tutorial</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Data Generation Tutorial</h1>
            
      

      <div class="d-none name"><code>Data_generation_tutorial.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://llrebecca21.github.io/HBEST/">HBEST</a></span><span class="op">)</span></span></code></pre></div>
<p>This package also contains some exported data generation functions to
help users replicate the data generation seen in the paper <span class="citation">Lee et al. (2025)</span>. The main data generation
function is <code><a href="../reference/gen_data.html">gen_data()</a></code>. This is a wrapper function that
easily allows users to choose the data generation they would like and
specify any additional required inputs. <code><a href="../reference/gen_data.html">gen_data()</a></code> calls
any of these functions:</p>
<ul>
<li><code><a href="../reference/generate_AR.html">generate_AR()</a></code></li>
<li><code><a href="../reference/generate_AR1_vary.html">generate_AR1_vary()</a></code></li>
<li><code><a href="../reference/generate_AR2_mixture.html">generate_AR2_mixture()</a></code></li>
<li><code><a href="../reference/generate_MA4.html">generate_MA4()</a></code></li>
<li><code>generate_MA4vary()</code></li>
<li><code>generate_MA4varyType2()</code></li>
</ul>
<p>Details of each of these functions can be found in their respective
help page. Each function is provided separately for the user as well.
However, this wrapper function is what is used in the other vignette
<code>HBEST_tutorial</code> and is recommended.</p>
<p>The package also contains two spectral density functions
<code><a href="../reference/arma_spec.html">arma_spec()</a></code> and <code><a href="../reference/arma_spec_vectorized.html">arma_spec_vectorized()</a></code> that
will calculate the spectral density for a given ARMA process. Both
functions have the same calculation, however the vectorized version is
useful if you have a large amount of time series
(<code>R &gt;&gt;</code>).</p>
<div class="section level2">
<h2 id="arp-input-to-gen_data">
<code>"ARp"</code> input to <code>gen_data()</code><a class="anchor" aria-label="anchor" href="#arp-input-to-gen_data"></a>
</h2>
<p>This input calls the <code><a href="../reference/generate_AR.html">generate_AR()</a></code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R</span> <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="co"># Time series of different lengths</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">500</span>, <span class="va">R</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">800</span>, <span class="va">R</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">burn</span> <span class="op">=</span> <span class="fl">50</span></span>
<span></span>
<span><span class="co">## `ARp` method:</span></span>
<span><span class="va">tmp</span> <span class="op">=</span> <span class="fu"><a href="../reference/gen_data.html">gen_data</a></span><span class="op">(</span></span>
<span>  gen_method <span class="op">=</span> <span class="st">"ARp"</span>,</span>
<span>  phi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  n <span class="op">=</span> <span class="va">n</span>,</span>
<span>  R <span class="op">=</span> <span class="va">R</span>,</span>
<span>  burn <span class="op">=</span> <span class="va">burn</span></span>
<span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># extract time series</span></span>
<span><span class="va">ts</span> <span class="op">=</span> <span class="va">tmp</span><span class="op">$</span><span class="va">ts_list</span></span>
<span></span>
<span><span class="co"># extract true_phi</span></span>
<span><span class="va">tp</span> <span class="op">=</span> <span class="va">tmp</span><span class="op">$</span><span class="va">true_phi</span></span>
<span></span>
<span><span class="co"># plot the time series</span></span>
<span><span class="co">## Create an empty plot</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>   x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>   y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>   xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">800</span><span class="op">)</span>,</span>
<span>   ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span>,</span>
<span>   ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>   xlab <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>   main <span class="op">=</span> <span class="st">"AR(0.5) of Varying Lengths"</span></span>
<span> <span class="op">)</span></span>
<span> <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ts</span><span class="op">[[</span><span class="va">r</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span> <span class="op">}</span></span>
<span> <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">11</span><span class="op">:</span><span class="va">R</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ts</span><span class="op">[[</span><span class="va">r</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span> <span class="op">}</span></span></code></pre></div>
<p><img src="Data_generation_tutorial_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" alt="" width="70%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="true-spectral-density-for-arp">True Spectral Density for <code>ARp</code><a class="anchor" aria-label="anchor" href="#true-spectral-density-for-arp"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">full_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fl">1000</span>, ncol <span class="op">=</span> <span class="va">R</span><span class="op">)</span></span>
<span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">pi</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="va">tp</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">R</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">full_spec</span><span class="op">[</span>,<span class="va">r</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/arma_spec_vectorized.html">arma_spec_vectorized</a></span><span class="op">(</span>omega <span class="op">=</span> <span class="va">omega</span>, phi <span class="op">=</span> <span class="va">phi</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">omega</span>,</span>
<span>        y <span class="op">=</span> <span class="va">full_spec</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">g</span><span class="op">(</span><span class="va">omega</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">omega</span><span class="op">)</span>,</span>
<span>        lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Data_generation_tutorial_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" alt="" width="70%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="ar1vary-input-to-gen_data">
<code>"AR1vary"</code> input to <code>gen_data()</code><a class="anchor" aria-label="anchor" href="#ar1vary-input-to-gen_data"></a>
</h2>
<p>This input calls the <code>generate_AR1vary()</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">R</span> <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="co"># Time series of different lengths</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">500</span>, <span class="va">R</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">800</span>, <span class="va">R</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">burn</span> <span class="op">=</span> <span class="fl">50</span></span>
<span></span>
<span><span class="co">## `AR1vary` method:</span></span>
<span> <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_data.html">gen_data</a></span><span class="op">(</span></span>
<span>   gen_method <span class="op">=</span> <span class="st">"AR1vary"</span>,</span>
<span>   n <span class="op">=</span> <span class="va">n</span>,</span>
<span>   R <span class="op">=</span> <span class="va">R</span>,</span>
<span>   min <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>   max <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>   burn <span class="op">=</span> <span class="va">burn</span></span>
<span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># extract time series</span></span>
<span><span class="va">ts</span> <span class="op">=</span> <span class="va">tmp</span><span class="op">$</span><span class="va">ts_list</span></span>
<span></span>
<span><span class="co"># extract true_phi</span></span>
<span><span class="va">tp</span> <span class="op">=</span> <span class="va">tmp</span><span class="op">$</span><span class="va">true_phi</span></span>
<span></span>
<span><span class="co"># plot the time series</span></span>
<span><span class="co">## Create an empty plot</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>   x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>   y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>   xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">800</span><span class="op">)</span>,</span>
<span>   ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span>,</span>
<span>   ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>   xlab <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>   main <span class="op">=</span> <span class="st">"Varying AR(1) of Varying Lengths"</span></span>
<span> <span class="op">)</span></span>
<span> <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ts</span><span class="op">[[</span><span class="va">r</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span> <span class="op">}</span></span>
<span> <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">11</span><span class="op">:</span><span class="va">R</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ts</span><span class="op">[[</span><span class="va">r</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span> <span class="op">}</span></span></code></pre></div>
<p><img src="Data_generation_tutorial_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" alt="" width="70%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="true-spectral-density-for-ar1vary">True Spectral Density for <code>AR1vary</code><a class="anchor" aria-label="anchor" href="#true-spectral-density-for-ar1vary"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">full_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fl">1000</span>, ncol <span class="op">=</span> <span class="va">R</span><span class="op">)</span></span>
<span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">pi</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="va">tp</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">R</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">full_spec</span><span class="op">[</span>,<span class="va">r</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/arma_spec_vectorized.html">arma_spec_vectorized</a></span><span class="op">(</span>omega <span class="op">=</span> <span class="va">omega</span>, phi <span class="op">=</span> <span class="va">phi</span><span class="op">[</span><span class="va">r</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">omega</span>,</span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">full_spec</span><span class="op">)</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="st">"log("</span><span class="op">*</span><span class="fu">g</span><span class="op">(</span><span class="va">omega</span><span class="op">)</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>,</span>
<span>        xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">omega</span><span class="op">)</span>,</span>
<span>        lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Data_generation_tutorial_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" alt="" width="70%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="ar2mix-input-to-gen_data">
<code>"AR2mix"</code> input to <code>gen_data()</code><a class="anchor" aria-label="anchor" href="#ar2mix-input-to-gen_data"></a>
</h2>
<p>This input calls the <code><a href="../reference/generate_AR2_mixture.html">generate_AR2_mixture()</a></code>
function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## `AR2mix` method:</span></span>
<span> <span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="co"># Time series of different lengths</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">500</span>, <span class="va">R</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">800</span>, <span class="va">R</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">peaks1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">R</span>, min <span class="op">=</span> <span class="fl">0.2</span>, max <span class="op">=</span> <span class="fl">0.23</span><span class="op">)</span></span>
<span> <span class="va">bandwidths1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">R</span>, min <span class="op">=</span> <span class="fl">.1</span>, max <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span></span>
<span> <span class="va">peaks2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">R</span>,</span>
<span>                 min <span class="op">=</span> <span class="op">(</span><span class="va">pi</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span> <span class="op">/</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.1</span>,</span>
<span>                 max <span class="op">=</span> <span class="op">(</span><span class="va">pi</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span> <span class="op">/</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span> <span class="va">bandwidths2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="va">R</span><span class="op">)</span></span>
<span> <span class="va">peaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">peaks1</span>, <span class="va">peaks2</span><span class="op">)</span></span>
<span> <span class="va">bandwidths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">bandwidths1</span>, <span class="va">bandwidths2</span><span class="op">)</span></span>
<span> </span>
<span> <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_data.html">gen_data</a></span><span class="op">(</span></span>
<span>   gen_method <span class="op">=</span> <span class="st">"AR2mix"</span>,</span>
<span>   peaks <span class="op">=</span> <span class="va">peaks</span>,</span>
<span>   bandwidths <span class="op">=</span> <span class="va">bandwidths</span>,</span>
<span>   n <span class="op">=</span> <span class="va">n</span></span>
<span> <span class="op">)</span></span>
<span> </span>
<span><span class="co"># extract time series</span></span>
<span><span class="va">ts</span> <span class="op">=</span> <span class="va">tmp</span><span class="op">$</span><span class="va">ts_list</span></span>
<span></span>
<span><span class="co"># extract out the phi1</span></span>
<span><span class="va">phi1_true</span> <span class="op">=</span> <span class="va">tmp</span><span class="op">$</span><span class="va">phi1_true</span></span>
<span><span class="co"># extract out the phi2</span></span>
<span><span class="va">phi2_true</span> <span class="op">=</span> <span class="va">tmp</span><span class="op">$</span><span class="va">phi2_true</span></span>
<span></span>
<span><span class="co"># plot the time series</span></span>
<span><span class="co">## Create an empty plot</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>   x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>   y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>   xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">800</span><span class="op">)</span>,</span>
<span>   ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span>,</span>
<span>   ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>   xlab <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>   main <span class="op">=</span> <span class="st">"Mixture AR(2) of Varying Lengths"</span></span>
<span> <span class="op">)</span></span>
<span> <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ts</span><span class="op">[[</span><span class="va">r</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span> <span class="op">}</span></span>
<span> <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">11</span><span class="op">:</span><span class="va">R</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ts</span><span class="op">[[</span><span class="va">r</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span> <span class="op">}</span></span></code></pre></div>
<p><img src="Data_generation_tutorial_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" alt="" width="70%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="true-log-spectral-density-for-ar2mix">True log Spectral Density for <code>AR2mix</code><a class="anchor" aria-label="anchor" href="#true-log-spectral-density-for-ar2mix"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">full_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fl">1000</span>, ncol <span class="op">=</span> <span class="va">R</span><span class="op">)</span></span>
<span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">pi</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the SDF for generated data:</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">R</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">omega</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">p</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">phi1_true</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">g</span> <span class="op">=</span> <span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="../reference/arma_spec_vectorized.html">arma_spec_vectorized</a></span><span class="op">(</span><span class="va">omega</span>, phi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">phi1_true</span><span class="op">[</span><span class="va">p</span>,<span class="va">r</span><span class="op">]</span>, <span class="va">phi2_true</span><span class="op">[</span><span class="va">p</span>,<span class="va">r</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">full_spec</span><span class="op">[</span>,<span class="va">r</span><span class="op">]</span> <span class="op">=</span> <span class="va">g</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">omega</span>,</span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">full_spec</span><span class="op">)</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="st">"log("</span><span class="op">*</span><span class="fu">g</span><span class="op">(</span><span class="va">omega</span><span class="op">)</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>,</span>
<span>        xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">omega</span><span class="op">)</span>,</span>
<span>        lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Data_generation_tutorial_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" alt="" width="70%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="ma4-input-to-gen_data">
<code>"MA4"</code> input to <code>gen_data()</code><a class="anchor" aria-label="anchor" href="#ma4-input-to-gen_data"></a>
</h2>
<p>This input calls the <code><a href="../reference/generate_MA4.html">generate_MA4()</a></code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R</span> <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="co"># Time series of different lengths</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">500</span>, <span class="va">R</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">800</span>, <span class="va">R</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">burn</span> <span class="op">=</span> <span class="fl">50</span></span>
<span></span>
<span><span class="co">## `MA4` method:</span></span>
<span> <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_data.html">gen_data</a></span><span class="op">(</span></span>
<span>   gen_method <span class="op">=</span> <span class="st">"MA4"</span>,</span>
<span>   n <span class="op">=</span> <span class="va">n</span>,</span>
<span>   R <span class="op">=</span> <span class="va">R</span>,</span>
<span>   burn <span class="op">=</span> <span class="va">burn</span></span>
<span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># extract time series</span></span>
<span><span class="va">ts</span> <span class="op">=</span> <span class="va">tmp</span><span class="op">$</span><span class="va">ts_list</span></span>
<span></span>
<span><span class="co"># extract true_phi</span></span>
<span><span class="va">tp</span> <span class="op">=</span> <span class="va">tmp</span><span class="op">$</span><span class="va">true_theta</span></span>
<span></span>
<span><span class="co"># plot the time series</span></span>
<span><span class="co">## Create an empty plot</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>   x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>   y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>   xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">800</span><span class="op">)</span>,</span>
<span>   ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span>,</span>
<span>   ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>   xlab <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>   main <span class="op">=</span> <span class="st">"MA(4) of Varying Lengths"</span></span>
<span> <span class="op">)</span></span>
<span> <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ts</span><span class="op">[[</span><span class="va">r</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span> <span class="op">}</span></span>
<span> <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">11</span><span class="op">:</span><span class="va">R</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ts</span><span class="op">[[</span><span class="va">r</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span> <span class="op">}</span></span></code></pre></div>
<p><img src="Data_generation_tutorial_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" alt="" width="70%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="true-spectral-density-for-ma4">True Spectral Density for <code>MA4</code><a class="anchor" aria-label="anchor" href="#true-spectral-density-for-ma4"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">full_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fl">1000</span>, ncol <span class="op">=</span> <span class="va">R</span><span class="op">)</span></span>
<span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">pi</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="va">tp</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">R</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">full_spec</span><span class="op">[</span>,<span class="va">r</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/arma_spec_vectorized.html">arma_spec_vectorized</a></span><span class="op">(</span>omega <span class="op">=</span> <span class="va">omega</span>, theta <span class="op">=</span> <span class="va">theta</span><span class="op">[</span>,<span class="va">r</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">omega</span>,</span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">full_spec</span><span class="op">)</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="st">"log("</span><span class="op">*</span><span class="fu">g</span><span class="op">(</span><span class="va">omega</span><span class="op">)</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>,</span>
<span>        xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">omega</span><span class="op">)</span>,</span>
<span>        lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Data_generation_tutorial_files/figure-html/unnamed-chunk-9-1.png" class="r-plt" alt="" width="70%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="ma4vary-input-to-gen_data">
<code>"MA4vary"</code> input to <code>gen_data()</code><a class="anchor" aria-label="anchor" href="#ma4vary-input-to-gen_data"></a>
</h2>
<p>This input calls the <code>generate_MA4vary()</code> function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R</span> <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="co"># Time series of different lengths</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">500</span>, <span class="va">R</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">800</span>, <span class="va">R</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">burn</span> <span class="op">=</span> <span class="fl">50</span></span>
<span></span>
<span><span class="co">## `MA4vary` method:</span></span>
<span> <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span> <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_data.html">gen_data</a></span><span class="op">(</span></span>
<span>   gen_method <span class="op">=</span> <span class="st">"MA4vary"</span>,</span>
<span>   n <span class="op">=</span> <span class="va">n</span>,</span>
<span>   R <span class="op">=</span> <span class="va">R</span>,</span>
<span>   burn <span class="op">=</span> <span class="va">burn</span>,</span>
<span>   alpha <span class="op">=</span> <span class="va">alpha</span></span>
<span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># extract time series</span></span>
<span><span class="va">ts</span> <span class="op">=</span> <span class="va">tmp</span><span class="op">$</span><span class="va">ts_list</span></span>
<span></span>
<span><span class="co"># extract true_phi</span></span>
<span><span class="va">tp</span> <span class="op">=</span> <span class="va">tmp</span><span class="op">$</span><span class="va">true_theta</span></span>
<span></span>
<span><span class="co"># plot the time series</span></span>
<span><span class="co">## Create an empty plot</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>   x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>   y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>   xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">800</span><span class="op">)</span>,</span>
<span>   ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span>,</span>
<span>   ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>   xlab <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>   main <span class="op">=</span> <span class="st">"Varying MA(4) of Varying Lengths"</span></span>
<span> <span class="op">)</span></span>
<span> <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ts</span><span class="op">[[</span><span class="va">r</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span> <span class="op">}</span></span>
<span> <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">11</span><span class="op">:</span><span class="va">R</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ts</span><span class="op">[[</span><span class="va">r</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span> <span class="op">}</span></span></code></pre></div>
<p><img src="Data_generation_tutorial_files/figure-html/unnamed-chunk-10-1.png" class="r-plt" alt="" width="70%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="true-spectral-density-for-ma4vary">True Spectral Density for <code>MA4vary</code><a class="anchor" aria-label="anchor" href="#true-spectral-density-for-ma4vary"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">full_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fl">1000</span>, ncol <span class="op">=</span> <span class="va">R</span><span class="op">)</span></span>
<span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">pi</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="va">tp</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">R</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">full_spec</span><span class="op">[</span>,<span class="va">r</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/arma_spec_vectorized.html">arma_spec_vectorized</a></span><span class="op">(</span>omega <span class="op">=</span> <span class="va">omega</span>, theta <span class="op">=</span> <span class="va">theta</span><span class="op">[</span>,<span class="va">r</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">omega</span>,</span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">full_spec</span><span class="op">)</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="st">"log("</span><span class="op">*</span><span class="fu">g</span><span class="op">(</span><span class="va">omega</span><span class="op">)</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>,</span>
<span>        xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">omega</span><span class="op">)</span>,</span>
<span>        lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Data_generation_tutorial_files/figure-html/unnamed-chunk-11-1.png" class="r-plt" alt="" width="70%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="ma4varytype2-input-to-gen_data">
<code>"MA4varyType2"</code> input to <code>gen_data()</code><a class="anchor" aria-label="anchor" href="#ma4varytype2-input-to-gen_data"></a>
</h2>
<p>This input calls the <code>generate_MA4varyType2()</code>
function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R</span> <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="co"># Time series of different lengths</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">500</span>, <span class="va">R</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">800</span>, <span class="va">R</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">burn</span> <span class="op">=</span> <span class="fl">50</span></span>
<span></span>
<span><span class="co">## `MA4vary` method:</span></span>
<span> <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span> <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_data.html">gen_data</a></span><span class="op">(</span></span>
<span>   gen_method <span class="op">=</span> <span class="st">"MA4varyType2"</span>,</span>
<span>   n <span class="op">=</span> <span class="va">n</span>,</span>
<span>   R <span class="op">=</span> <span class="va">R</span>,</span>
<span>   burn <span class="op">=</span> <span class="va">burn</span>,</span>
<span>   alpha <span class="op">=</span> <span class="va">alpha</span></span>
<span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># extract time series</span></span>
<span><span class="va">ts</span> <span class="op">=</span> <span class="va">tmp</span><span class="op">$</span><span class="va">ts_list</span></span>
<span></span>
<span><span class="co"># extract true_phi</span></span>
<span><span class="va">tp</span> <span class="op">=</span> <span class="va">tmp</span><span class="op">$</span><span class="va">true_theta</span></span>
<span></span>
<span><span class="co"># plot the time series</span></span>
<span><span class="co">## Create an empty plot</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>   x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>   y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>   xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">800</span><span class="op">)</span>,</span>
<span>   ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span>,</span>
<span>   ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>   xlab <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>   main <span class="op">=</span> <span class="st">"Varying Type 2 MA(4) of Varying Lengths"</span></span>
<span> <span class="op">)</span></span>
<span> <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ts</span><span class="op">[[</span><span class="va">r</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span> <span class="op">}</span></span>
<span> <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">11</span><span class="op">:</span><span class="va">R</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ts</span><span class="op">[[</span><span class="va">r</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span> <span class="op">}</span></span></code></pre></div>
<p><img src="Data_generation_tutorial_files/figure-html/unnamed-chunk-12-1.png" class="r-plt" alt="" width="70%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="true-spectral-density-for-ma4varytype2">True Spectral Density for <code>MA4varyType2</code><a class="anchor" aria-label="anchor" href="#true-spectral-density-for-ma4varytype2"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">full_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fl">1000</span>, ncol <span class="op">=</span> <span class="va">R</span><span class="op">)</span></span>
<span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">pi</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="va">tp</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">R</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">full_spec</span><span class="op">[</span>,<span class="va">r</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/arma_spec_vectorized.html">arma_spec_vectorized</a></span><span class="op">(</span>omega <span class="op">=</span> <span class="va">omega</span>, theta <span class="op">=</span> <span class="va">theta</span><span class="op">[</span>,<span class="va">r</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">omega</span>,</span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">full_spec</span><span class="op">)</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="st">"log("</span><span class="op">*</span><span class="fu">g</span><span class="op">(</span><span class="va">omega</span><span class="op">)</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>,</span>
<span>        xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">omega</span><span class="op">)</span>,</span>
<span>        lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Data_generation_tutorial_files/figure-html/unnamed-chunk-13-1.png" class="r-plt" alt="" width="70%" style="display: block; margin: auto;"></p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-lee_hierarchical_2025" class="csl-entry">
Lee, Rebecca, Alexander Coulter, Greg J. Siegle, Scott A. Bruce, and
Anirban Bhattacharya. 2025. <span>â€œHierarchical <span>Bayesian</span>
Spectral Analysis of Multiple Stationary Time Series.â€</span> arXiv. <a href="https://doi.org/10.48550/ARXIV.2511.19406" class="external-link">https://doi.org/10.48550/ARXIV.2511.19406</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rebecca Lee.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
